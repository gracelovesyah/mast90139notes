

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.1 Heart Disease Example &#8212; My sample book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex2jax": {"inlineMath": [["$", "$"]]}}</script>
    <script defer="defer" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'c2.1';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2.2 Interpretation &amp; Hypothesis &amp; CI" href="c2.2.html" />
    <link rel="prev" title="Chapter 2 Binary Response" href="Chapter2_Binary_Response.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to MAST90139
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Introduction.html">Chapter 1 Introduction</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Chapter2_Binary_Response.html">Chapter 2 Binary Response</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">2.1 Heart Disease Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="c2.2.html">2.2 Interpretation &amp; Hypothesis &amp; CI</a></li>
<li class="toctree-l2"><a class="reference internal" href="c2.4.html">2.4 Diagnostic in binary regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="c2.5.html">2.5 Model selection in logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="c2.6.html">2.6 Goodness of fit &amp; $\chi^2$ Test</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Chapter3_GLM.html">Chapter 3 GLM</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="c3.1.html">3.1 Intro</a></li>

<li class="toctree-l2"><a class="reference internal" href="c3.2.html">3.2 Model Adeuqacy &amp; Model Comparison</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Chapter4_Categorical_Data_Analysis_by_Logistic_Regression_Models.html">Chapter 4 Categorical Data Analysis by Logistic Regression Models</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="c4.1.html">4.1 Intro</a></li>

<li class="toctree-l2"><a class="reference internal" href="c4.3.html">4.3 Bernoulli trials and the binomial distribution</a></li>

</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Chapter5_Analysis_of_Contingency_Tables_by_Log_Linear_Models.html">Chapter 5 Analysis of Contingency Tables by Log Linear Models</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="Practicals.html">Practicals</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tut1.html">Prac1</a></li>




<li class="toctree-l2"><a class="reference internal" href="tut2.html">Prac2</a></li>
<li class="toctree-l2"><a class="reference internal" href="tut3.html">Prac3</a></li>
<li class="toctree-l2"><a class="reference internal" href="tut4.html">Prac4</a></li>
<li class="toctree-l2"><a class="reference internal" href="tut5.html">Prac5</a></li>


<li class="toctree-l2"><a class="reference internal" href="tut6.html">Prac6</a></li>

<li class="toctree-l2"><a class="reference internal" href="tut7.html">Prac7</a></li>
<li class="toctree-l2"><a class="reference internal" href="tut8.html">Prac8</a></li>
<li class="toctree-l2"><a class="reference internal" href="tut9.html">Prac9</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fc2.1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/c2.1.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>2.1 Heart Disease Example</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistic-model">Statistic Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-names">Parameter Names</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-estimation">Parameter estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#log-likelihood">Log Likelihood</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#score-function">Score function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hessian-function">Hessian function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#observed-information">Observed information</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fisher-information">Fisher information</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mle">MLE</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-find-mle-chatgpt">How to find MLE (ChatGPT)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-coding">Useful Coding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lr-model-fit">LR model fit</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p>/* cSpell:disable */</p>
<div class="section" id="heart-disease-example">
<h1>2.1 Heart Disease Example<a class="headerlink" href="#heart-disease-example" title="Permalink to this heading">#</a></h1>
<blockquote>
<div><p>This study focused on finding the influential factors of getting(yes or no) a coronary heart diseas(chd) by fitting logistic regression (as the response is binary).</p>
</div></blockquote>
<div class="section" id="logistic-regression">
<h2>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Permalink to this heading">#</a></h2>
<div class="admonition-when-to-use admonition">
<p class="admonition-title">When to use </p>
<p>Suppose the response variable Y is binary with P (Y = 1) = p and P (Y = 0) = 1 p.
Thus Y follows a Bernoulli (a special binomial) distribution.</p>
</div>
<div class="section" id="statistic-model">
<h3>Statistic Model<a class="headerlink" href="#statistic-model" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight" id="equation-main-idea">
<span class="eqno">(1)<a class="headerlink" href="#equation-main-idea" title="Permalink to this equation">#</a></span>\[\begin{split}log\frac{p_i}{1-p_i} &amp;= \beta_0 + \beta_1x_{i1} + ... + \beta_qx_{iq}\\
\frac{p_i}{1-p_i} &amp;= e^{\beta_0} \cdot e^{\beta_1x_{i1}} \cdot ... \cdot e^{\beta_qx_{iq}}\end{split}\]</div>
<p>Link predictor &amp; Link &amp; Probability <br></p>
<div class="math notranslate nohighlight" id="equation-p-and-e">
<span class="eqno">(2)<a class="headerlink" href="#equation-p-and-e" title="Permalink to this equation">#</a></span>\[\begin{split}\eta_i &amp;= log\frac{p_i}{1-p_i}\\
p_i &amp;= \frac{e^{\eta_i }}{1+ e^{\eta_i }} =  \frac{1}{1+ e^{-\eta_i }}\\
e^{\eta_i} &amp;= \frac{p_i}{1-p_i}\\
1-p_i &amp;= \frac{1}{1+ e^{\eta_i}} =  \frac{e^{-\eta_i }}{1+ e^{-\eta_i}}\end{split}\]</div>
<a class="bg-primary mb-1 reference internal image-reference" href="_images/probodds.png"><img alt="probodds" class="bg-primary mb-1 align-center" src="_images/probodds.png" style="width: 300px;" /></a>
</div>
<div class="section" id="parameter-names">
<h3>Parameter Names<a class="headerlink" href="#parameter-names" title="Permalink to this heading">#</a></h3>
<div class="admonition-names admonition">
<p class="admonition-title">Names</p>
<p>Linear predictor: $$\eta_i$$
Logistic link: $$ \eta_i = log\frac{p_i}{1-p_i}$$
Log odds AKA logit ($\gamma$): $$log\frac{p_i}{1-p_i}$$
$$
logit(p_i)
$$
Odds ($\phi$): $$\frac{p_i}{1-p_i}$$ $$ e^{\gamma}$$
Odds ratio: $$e^{\eta}$$
Note: $\eta_i = \beta_0 + \beta_1x_{i1} = \boldsymbol{x_i}^\top \boldsymbol{\beta}$</p>
<p>$p$ is denoted as $\pi$ sometimes.</p>
</div>
</div>
<div class="section" id="parameter-estimation">
<h3>Parameter estimation<a class="headerlink" href="#parameter-estimation" title="Permalink to this heading">#</a></h3>
<div class="admonition-main-idea admonition">
<p class="admonition-title">Main Idea</p>
<p>To estimate $\beta$ by the method of maximum likelihood This can be achieved withe the log-likelihood function $l(\beta)$.</p>
</div>
<div class="section" id="log-likelihood">
<h4>Log Likelihood<a class="headerlink" href="#log-likelihood" title="Permalink to this heading">#</a></h4>
<p>The likelihood function (often simply called the likelihood) is the joint probability of the observed data viewed as a function of the parameters of a statistical model. Mathmatical proof can be seen at this
<a href="https://www.statlect.com/fundamentals-of-statistics/logistic-model-maximum-likelihood" target="_blank">link</a>.</p>
<div class="math notranslate nohighlight" id="equation-log-like">
<span class="eqno">(3)<a class="headerlink" href="#equation-log-like" title="Permalink to this equation">#</a></span>\[\begin{split}l(\boldsymbol{\beta} | \boldsymbol{y}, \boldsymbol{X}) &amp;= \sum_{i=1}^{n} \left[y_i \log p_i + (1 - y_i) \log (1 - p_i)\right]\\
l(\boldsymbol{\beta} | \boldsymbol{y}, \boldsymbol{X}) &amp;= \sum_{i=1}^{n} y_i \log \left(\frac{1}{1 + e^{-\boldsymbol{x_i}^\top \boldsymbol{\beta}}}\right) + (1 - y_i) \log \left(\frac{e^{-\boldsymbol{x_i}^\top \boldsymbol{\beta}}}{1 + e^{-\boldsymbol{x_i}^\top \boldsymbol{\beta}}}\right)\end{split}\]</div>
<p>This transformation is done with <a class="reference internal" href="smds/c2.1%202.html#equation-p-and-e">()</a></p>
</div>
<div class="section" id="score-function">
<h4>Score function<a class="headerlink" href="#score-function" title="Permalink to this heading">#</a></h4>
<p>first derivative of log-likelihood function</p>
<div class="math notranslate nohighlight" id="equation-sf">
<span class="eqno">(4)<a class="headerlink" href="#equation-sf" title="Permalink to this equation">#</a></span>\[u(\beta) = \frac{\partial \boldsymbol{l}(\boldsymbol{\beta} | \boldsymbol{y}, \boldsymbol{X})}{\partial \boldsymbol{\beta}} = \sum_{i=1}^{n} (\boldsymbol{x_i}^\top (\boldsymbol{y} - \boldsymbol{p}))\]</div>
</div>
<div class="section" id="hessian-function">
<h4>Hessian function<a class="headerlink" href="#hessian-function" title="Permalink to this heading">#</a></h4>
<p>second derivative of log-likelihood function</p>
<div class="math notranslate nohighlight" id="equation-hf">
<span class="eqno">(5)<a class="headerlink" href="#equation-hf" title="Permalink to this equation">#</a></span>\[\boldsymbol{H}(\boldsymbol{\beta} | \boldsymbol{X}) = -\sum_{i=1}^{n} p_i (1-p_i) \boldsymbol{x_i} \boldsymbol{x_i}^\top\]</div>
</div>
<div class="section" id="observed-information">
<h4>Observed information<a class="headerlink" href="#observed-information" title="Permalink to this heading">#</a></h4>
<p>Negative Hessian function <a class="reference internal" href="smds/c2.1%202.html#equation-hf">()</a>
$$
\boldsymbol{I}(\boldsymbol{\beta} | \boldsymbol{X}) = -\frac{\partial^2 \boldsymbol{l}(\boldsymbol{\beta} | \boldsymbol{y}, \boldsymbol{X})}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^\top} = \sum_{i=1}^{n} p_i (1-p_i) \boldsymbol{x_i} \boldsymbol{x_i}^\top
$$</p>
</div>
<div class="section" id="fisher-information">
<h4>Fisher information<a class="headerlink" href="#fisher-information" title="Permalink to this heading">#</a></h4>
<p>Negative Expetation of Hessian function <a class="reference internal" href="smds/c2.1%202.html#equation-hf">()</a>
$$
\boldsymbol{J}(\boldsymbol{\beta} | \boldsymbol{X}) = \mathbb{E} \left[ -\frac{\partial^2 \log f(\boldsymbol{y} | \boldsymbol{X}, \boldsymbol{\beta})}{\partial \boldsymbol{\beta} \partial \boldsymbol{\beta}^\top} \right] = \mathbb{E}  \sum_{i=1}^{n} p_i (1-p_i) \boldsymbol{x_i} \boldsymbol{x_i}^\top
$$</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For logistic regression Fisher Information is equivalent to Observed information</p>
</div>
</div>
<div class="section" id="mle">
<h4>MLE<a class="headerlink" href="#mle" title="Permalink to this heading">#</a></h4>
<p>$$
\hat{\boldsymbol{\beta}} = \arg\max_{\boldsymbol{\beta}} \boldsymbol{l}(\boldsymbol{\beta} | \boldsymbol{y}, \boldsymbol{X})
$$
$$
\boldsymbol{\beta}^{(t+1)} = \boldsymbol{\beta}^{(t)} + \left(\boldsymbol{J}(\boldsymbol{\beta}^{(t)})\right)^{-1} \boldsymbol{u}(\boldsymbol{\beta}^{(t)})
$$
Where J is fisher information <a class="reference internal" href="smds/c2.1%202.html#equation-fi">()</a>, u is score function<a class="reference internal" href="smds/c2.1%202.html#equation-sf">()</a></p>
</div>
<hr class="docutils" />
<div class="section" id="how-to-find-mle-chatgpt">
<h4>How to find MLE (ChatGPT)<a class="headerlink" href="#how-to-find-mle-chatgpt" title="Permalink to this heading">#</a></h4>
<p>Sure, here’s the reformatted answer with $..$ for in-text LaTeX:</p>
<p>To find the estimate of the maximum likelihood estimator (MLE) for a given statistical model, you need to follow these steps:</p>
<ol class="arabic simple">
<li><p>Write down the likelihood function for the model, which is the probability of observing the data given the model parameters.</p></li>
<li><p>Take the natural logarithm of the likelihood function to obtain the log-likelihood function.</p></li>
<li><p>Compute the partial derivatives of the log-likelihood function with respect to each model parameter.</p></li>
<li><p>Set each partial derivative to zero and solve for the corresponding parameter value(s). These values correspond to the maximum of the log-likelihood function, and therefore, they are the estimates of the MLE.</p></li>
<li><p>Check that the second derivative of the log-likelihood function evaluated at the MLE estimate(s) is negative, which ensures that the MLE estimate(s) correspond to a maximum rather than a minimum or a saddle point.</p></li>
</ol>
<p>Here is an example of finding the MLE estimate for the mean parameter of a normal distribution:</p>
<ol class="arabic simple">
<li><p>The likelihood function for a random sample of size $n$ from a normal distribution with mean $\mu$ and variance $\sigma^2$ is given by:</p></li>
</ol>
<p>$$ L(\mu, \sigma^2) = (2\pi\sigma^2)^{-n/2} \cdot \exp\left[-\frac{\sum\left((x_i - \mu)^2\right)}{2\sigma^2}\right],$$</p>
<p>where $x_i$ are the observed data points.</p>
<ol class="arabic simple" start="2">
<li><p>The log-likelihood function is:</p></li>
</ol>
<p>$$ \ln L(\mu, \sigma^2) = -\frac{n}{2}\ln(2\pi\sigma^2) - \frac{1}{2\sigma^2}\sum\left((x_i - \mu)^2\right).$$</p>
<ol class="arabic simple" start="3">
<li><p>The partial derivative of the log-likelihood function with respect to $\mu$ is:</p></li>
</ol>
<p>$$ \frac{\partial}{\partial \mu}\ln L(\mu, \sigma^2) = \frac{1}{2\sigma^2}\sum(x_i - \mu).$$</p>
<ol class="arabic simple" start="4">
<li><p>Setting the partial derivative to zero and solving for $\mu$ gives:</p></li>
</ol>
<p>$$ \sum(x_i - \mu) = 0,$$</p>
<p>which implies that:</p>
<p>$$ \mu = \frac{1}{n}\sum x_i.$$</p>
<p>Therefore, the MLE estimate for $\mu$ is the sample mean.</p>
<ol class="arabic simple" start="5">
<li><p>The second derivative of the log-likelihood function with respect to $\mu$ is:</p></li>
</ol>
<p>$$\frac{\partial^2}{\partial \mu^2}\ln L(\mu, \sigma^2) = -\frac{n}{2\sigma^2},$$</p>
<p>which is negative for all values of $\mu$ and $\sigma^2$, so the MLE estimate for $\mu$ corresponds to a maximum of the log-likelihood function.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="useful-coding">
<h2>Useful Coding<a class="headerlink" href="#useful-coding" title="Permalink to this heading">#</a></h2>
<div class="section" id="exploratory-data-analysis">
<h3>Exploratory Data Analysis<a class="headerlink" href="#exploratory-data-analysis" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Read data
dim(wcgs)
head(wcgs) 
summary(wcgs)

# Plot data
# Box plot
plot(height ~ chd, wcgs); wcgs$y &lt;- ifelse(wcgs$chd == &quot;no&quot;,0,1)
plot(jitter(y,0.1)~jitter(height),wcgs,xlab=&quot;Height&quot;,ylab=&quot;Heart Disease&quot;,pch=&quot;.&quot;) 

# Scatter Plot
ggplot(wcgs,aes(x=height,color=chd))+geom_histogram(position=&quot;dodge&quot;,binwidth=1)
ggplot(wcgs, aes(x=cigs, color=chd)) + geom_histogram(position=&quot;dodge&quot;, binwidth=5, aes(y=..density..))
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From the above plots we found that there is relationship pattern between height, cigarette usage and chd. Although we want to fit a linear model, the response of linear model can’t be binary. Hence we use <b>logistic regression</b> to present the response (chd) in terms of probability</p>
</div>
</div>
<div class="section" id="lr-model-fit">
<h3>LR model fit<a class="headerlink" href="#lr-model-fit" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">lmod</span> <span class="o">&lt;-</span> <span class="n">glm</span><span class="p">(</span><span class="n">chd</span> <span class="o">~</span> <span class="n">height</span> <span class="o">+</span> <span class="n">cigs</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="n">binomial</span><span class="p">,</span> <span class="n">wcgs</span><span class="p">)</span> 
<span class="n">beta</span> <span class="o">&lt;-</span> <span class="n">coef</span><span class="p">(</span><span class="n">lmod</span><span class="p">);</span> <span class="n">summary</span><span class="p">(</span><span class="n">lmod</span><span class="p">)</span> 
<span class="n">plot</span><span class="p">(</span><span class="n">jitter</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">~</span> <span class="n">jitter</span><span class="p">(</span><span class="n">height</span><span class="p">),</span> <span class="n">wcgs</span><span class="p">,</span> <span class="n">xlab</span><span class="o">=</span><span class="s2">&quot;Height&quot;</span><span class="p">,</span> <span class="n">ylab</span><span class="o">=</span><span class="s2">&quot;Heart Disease&quot;</span><span class="p">,</span>
<span class="n">pch</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<blockquote>
<div><p>In R, adding jitter to a plot means adding a small amount of random noise to the data points to help visualize overlapping points. This can be useful when visualizing categorical or discrete data, as it can help distinguish data points that are otherwise indistinguishable due to their exact values being the same.</p>
</div></blockquote>
<p>Here is a <a class="reference internal" href="intro.html"><span class="doc std std-doc">reference to the intro</span></a>. Here is a reference to <a class="reference internal" href="smds/mymarkdown.html#section-label"><span class="std std-ref">Here’s my first section</span></a>.1</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter2_Binary_Response.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 2 Binary Response</p>
      </div>
    </a>
    <a class="right-next"
       href="c2.2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2.2 Interpretation &amp; Hypothesis &amp; CI</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#statistic-model">Statistic Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-names">Parameter Names</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameter-estimation">Parameter estimation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#log-likelihood">Log Likelihood</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#score-function">Score function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hessian-function">Hessian function</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#observed-information">Observed information</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fisher-information">Fisher information</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mle">MLE</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-find-mle-chatgpt">How to find MLE (ChatGPT)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#useful-coding">Useful Coding</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exploratory-data-analysis">Exploratory Data Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lr-model-fit">LR model fit</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book Community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>